<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>CV Template 2</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
    <style>
        @page { size: A4; }
        @media print {
            html {
                height: 297mm;
            }
            .section::before {
                display: block;
                content: "";
                margin-top: -297mm;
                height: 297mm;
                visibility: hidden;
            }
        }
        body {
            font-family: 'Cormorant Garamond', serif;
            margin: 10mm auto;
            width: 210mm;
            color: #000;
        //border: 2px solid black;
        }
        input, textarea, div[contenteditable="true"] {
            font-family: 'Cormorant Garamond', serif;
        }

        .cv-container {
            width: 100%;
            min-height: 29.7cm;
            max-width: 100%;
            margin: 1rem auto;
            background-color: #fff;
            padding: 1.5rem;
            box-sizing: border-box;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
        h1 {
            margin-top: 0;
            text-align: center;
            margin-bottom: 1px;
        }
        .contact-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 25px;
            animation: fadeIn 1s ease;
        }
        .contact-fields {
            display: flex;
            flex-wrap: nowrap;
            gap: 4px;
            justify-content: center;
            align-items: center;
            margin-bottom: 30px;
            font-size: 0.85rem;
            color: #444;
        }
        .contact-field {
            display: flex;
            align-items: center;
            gap: 6px;
            animation: fadeIn 0.5s ease;
        }
        .contact-field input[type="text"],
        .contact-field input[type="email"] {
            font-size : 12px;
            border: none;
            background-color: transparent;
            box-shadow: none;
            overflow-x: auto;
            white-space: nowrap;
        }
        .contact-field input {
            border: none;
            outline: none;
            box-shadow: none;
        }
        .contact-options {
            background: #f2f2f2;
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            text-align: center;
            animation: fadeIn 1s ease;
        }
        .contact-options h2 {
            font-size: 1rem;
            margin-bottom: 15px;
            color: #666;
        }
        h2 {
            margin-bottom: 0;
        }
        .buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-bottom: 15px;
        }
        .contact-btn {
            background-color: #ddd;
            color: #333;
            border: none;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }
        .contact-btn:hover {
            background-color: #ccc;
            transform: translateY(-2px);
        }
        .done-btn {
            background-color: #730D3F;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }
        .done-btn:hover {
            background-color: #730D3F;
            transform: translateY(-2px);
        }
        input[type="text"], input[type="email"] {
            font-size: 0.8rem;
            padding: 5px 8px;
            border: 1px solid #ccc;
            border-radius: 6px;
            width: 170px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-10px); }
        }
        .contact-info {
            display: flex;
            justify-content: space-around;
            align-items: center;
            text-align: center;
            margin-bottom: 1.2rem;
            font-size: 0.40rem;
        }

        .contact-info-icon, .contact-info-divider {
            font-size: 0.95rem;
        }

        .contact-info input {
            border: none;
            border-bottom: 1px solid #ccc;
            outline: none;
            font-size: 0.5rem;
            padding: 0 4px;
        }
        .bullet-list { list-style: disc; margin-left: 2rem; }
        .column-layout { display: flex; gap: 3rem; }
        .left, .right { flex: 1; }
        .strengths span, .languages span {
            display: inline-block;
            background-color: #ddd;
            padding: 0.25rem 0.5rem;
            margin: 0.25rem;
            border-radius: 5px;
        }
        ul {
            padding-left: 1.3rem;
            margin: 0;
        }

        li {
            margin-bottom: 0;
        }

        .custom-li {
            position: relative;
            list-style-type: none;
        }

        .custom-li::before {
            content: "◦";
            position: absolute;
            top: -3px;
            left: -15px;
            font-size: 20px;
        }
        .add-button {
            cursor: pointer;
            font-weight: bold;
            margin-left: 10px;
            color: #730D3F;
        }

        .delete-button {
            cursor: pointer;
            font-weight: bold;
            color: red;
            font-size: 18px;
            margin-left: 10px;
            transition: transform 0.3s;
        }

        .delete-button:hover {
            transform: scale(1.2);
        }

        .add-button:hover {
            color: #730D3F;
        }
        .language-level {
            display: inline-flex;
            front-size:1.2rem;
            margin-left: 8px;
            cursor: pointer;
        }
        .language-level span {
            margin: 0 1px;
            font-size: 1.2rem;
            user-select: none;
        }
        .section {
            margin-top: 0;
            margin-bottom: 0;
        }
        textarea {
            margin: 0;
        }
        .generate-pdf-btn {
            background-color: #730D3F;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.3s;
        }
        .generate-pdf-btn:hover {
            background-color: #730D3F;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
<div class="cv-container">
    <h1><input id="name" type="text" placeholder="Your Full Name" style="font-size:40px;width:80%;border:none;text-align:center;" /></h1>
    <div class="contact-wrapper">
        <div id="contact-fields" class="contact-fields"></div>

        <div id="contact-options" class="contact-options">
            <h2>Select Your Contact Information</h2>
            <div class="buttons">
                <button onclick="addContactField('email')" class="contact-btn">Email</button>
                <button onclick="addContactField('phone')" class="contact-btn">Phone</button>
                <button onclick="addContactField('address')" class="contact-btn">Address</button>
                <button onclick="addContactField('linkedin')" class="contact-btn">LinkedIn</button>
                <button onclick="addContactField('github')" class="contact-btn">GitHub</button>
            </div>
            <button onclick="finalizeContactFields()" class="done-btn">Done</button>
        </div>
    </div>

    <div class="column-layout">
        <div class="left">
            <h2>Experience
                <span class="add-button" onclick="addExperience()">➕</span>
                <span class="delete-button" onclick="removeLast('sexperience-list')">🗑</span>
            </h2>
            <div id="experience-list"></div>

            <h2>Projects
                <span class="add-button" onclick="addProject()">➕</span>
                <span class="delete-button" onclick="removeLast('projects-list')">🗑</span>
            </h2>
            <div id="projects-list"></div>

            <h2>Skills
                <span class="add-button" onclick="addSkill()">➕</span>
                <span class="delete-button" onclick="removeLast('skills-list')">🗑</span>
            </h2>
            <div id="skills-list"></div>
        </div>

        <div class="right">
            <h2>My Life Philosophy</h2>
            <textarea style="border:none; width: 100%; height: 15px;" placeholder="Something smart or heartfelt."></textarea></p>

            <h2>Most Proud Of</h2>
            <ul class="bullet-list">
                <li><textarea style="border:none; width: 100%; height: 15px;" placeholder="Achievement 1"></textarea></li>
                <li><textarea style="border:none; width: 100%; height: 15px;" placeholder="Achievement 2"></textarea></li>
                <li><textarea style="border:none; width: 100%; height: 15px;" placeholder="Achievement 3"></textarea></li>
            </ul>

            <h2>Strengths
                <span class="add-button" onclick="addStrength()">➕</span>
                <span class="delete-button" onclick="removeLast('strengths')">🗑</span>
            </h2>
            <div class="strengths"
                 id="strengths"></div>

            <h2>Languages
                <span class="add-button" onclick="addLanguage()">➕</span>
                <span class="delete-button" onclick="removeLast('languages')">🗑</span>
            </h2>
            <div class="languages"
                 id="languages"></div>

            <h2>Education
                <span class="add-button" onclick="addEducation()">➕</span>
                <span class="delete-button" onclick="removeLast('education-list')">🗑</span>
            </h2>
            <div id="education-list"></div>
        </div>
    </div>
    <div class="section">
        <h2>
            <span class="add-button" onclick="addRODO()">➕</span>
            <span class="delete-button" onclick="removeLast('rodo-section')">🗑</span>
        </h2>
        <div id="rodo-section"></div>
    </div>
    <button id="toggle-edit" class="done-btn">Finished</button>
    <button id="generate-pdf-btn" class="generate-pdf-btn" onclick="generatePDF(event)" style="display:none;">Generate PDF</button>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>


<script>

    let originalInputs = [];
    function replaceInputsWithText() {
        const container = document.getElementById("contact-fields");
        const fields = container.querySelectorAll(".contact-field");

        fields.forEach(field => {
            const input = field.querySelector("input");
            const icon = field.querySelector("i");

            if (input && icon) {
                const value = input.value.trim();
                field.innerHTML = '';

                if (value !== '') {
                    const newIcon = document.createElement("i");
                    newIcon.className = icon.className;

                    const span = document.createElement("span");
                    span.textContent = value;
                    span.style.marginRight = "40px";

                    field.appendChild(newIcon);
                    field.appendChild(span);
                } else {
                    field.remove();
                }
            }
        });

        contactFieldsAdded = 0;
    }

    function restoreInputs() {
        originalInputs.forEach(item => {
            item.parent.replaceChild(item.input, item.clone);
        });
    }

    function generatePDF(event) {
        event.preventDefault();

        const buttons = document.querySelectorAll('button');
        buttons.forEach(btn => btn.style.display = 'none');

        replaceInputsWithText();

        const cvContainer = document.querySelector('.cv-container');

        const opt = {
            margin: [0, 0, 0, 0],
            filename: 'CV.pdf',
            image: { type: 'jpeg', quality: 1 },
            html2canvas: { scale: 4, useCORS: true, letterRendering: true },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
            enableLinks: true,
            pagebreak: { mode: ['css', 'legacy'] }
        };

        html2pdf().from(cvContainer).set(opt).save()
            .then(() => {
                restoreInputs();
                buttons.forEach(btn => btn.style.display = 'inline-block');
            })
            .catch((error) => {
                console.error('Błąd podczas generowania PDF:', error);
                restoreInputs();
                buttons.forEach(btn => btn.style.display = 'inline-block');
            });
    }

    function replaceTextWithInputs() {
        if (!originalInputs || originalInputs.length === 0) {
            return;
        }

        originalInputs.forEach(entry => {
            entry.parent.replaceChild(entry.input, entry.clone);
        });

        originalInputs = [];
    }

    function autoGrow(id) {
        const element = document.getElementById(id);
        if (element) {
            element.style.height = "auto";
            element.style.height = (element.scrollHeight) + "px";
        }
    }
    function createDeleteButton(parent) {
        const btn = document.createElement('span');
        btn.className = 'delete-button';
        btn.textContent = '🗑';
        btn.onclick = () => parent.remove();
        return btn;
    }

    function addExperience() {
        const div = document.createElement("div");
        div.className = "dynamic-entry";
        div.innerHTML = `
        <div style="display: flex; flex-direction: column; justify-content: flex-start;">
            <div style="display: flex; justify-content: space-between;">
                <div style="font-size:17px; font-weight:bold;">
                    <textarea style="border:none; width: 100%; height: 17px; font-size:17px; font-weight:bold; margin-bottom: 0;" placeholder="Position"></textarea>
                </div>
                <div>
                    <textarea style="border:none; width: 100%; height: 17px;" placeholder="Period"></textarea>
                </div>
            </div>
            <div style="margin-top:4px;">
              <textarea style="border:none; width: 100%; height: 15px;font-size:15px;" placeholder="Company"></textarea>
            </div>
        </div>
        <ul>
            <li class="custom-li"><textarea style="width: 100%; height: 34px; border:none;" placeholder="Responsibilities or achievement"></textarea></li>
        </ul>`;
        document.getElementById("experience-list").appendChild(div);
    }

    function addProject() {
        const div = document.createElement("div");
        div.className = "dynamic-entry";
        div.innerHTML = `
    <div style="display: flex; align-items: center;">
        <textarea style="width: 100%; height: 17px; border:none; font-size:17px; font-weight:bold;" placeholder="Project name"></textarea>
    </div>
    <ul>
         <li class="custom-li" style="margin-top:0;"><textarea style="border:none; width: 100%; height: 15px;  font-size:15px;" placeholder="Project link (github.com/...)"></textarea></li>
         <li class="custom-li"><textarea style="border:none; width: 100%; height: 34px;" placeholder="Project feature or functionality"></textarea></li>
    </ul>`;
        document.getElementById("projects-list").appendChild(div);
    }

    function addSkill() {
        const div = document.createElement("div");
        div.className = "dynamic-entry";
        div.innerHTML = `
    <ul>
        <li class="custom-li">
            <div contenteditable="true" oninput="updateStyle(this)" placeholder="Skill"
                 style="width: 100%; min-height: 15px; border:none; font-weight: 400; font-size: 14px;"></div>
        </li>
    </ul>`;
        document.getElementById("skills-list").appendChild(div);
    }

    function updateStyle(el) {
        const text = el.innerText;
        const match = text.match(/^([^:]+:)(.*)$/);

        if (match) {
            const boldPart = match[1].trim();
            const normalPart = match[2];
            el.innerHTML = `<strong style="font-weight: 1000;">${boldPart}</strong>${normalPart}`;
            placeCaretAtEnd(el);
        }
    }


    function placeCaretAtEnd(el) {
        const range = document.createRange();
        const sel = window.getSelection();
        range.selectNodeContents(el);
        range.collapse(false);
        sel.removeAllRanges();
        sel.addRange(range);
    }

    let contactFieldsAdded = 0;
    function addContactField(type) {
        if (contactFieldsAdded >= 4) {
            alert("You can only add up to 4 contact fields.");
            return;
        }
        const fields = {
            email: { icon: "fas fa-envelope", placeholder: "your.email@gmail.com", inputType: "email", id: "contact-email" },
            phone: { icon: "fas fa-phone", placeholder: "+1 000 000 0000", inputType: "text", id: "contact-phone" },
            address: { icon: "fas fa-home", placeholder: "Address, City, Country", inputType: "text", id: "contact-address" },
            linkedin: { icon: "fab fa-linkedin", placeholder: "linkedin.com/in/yourprofile", inputType: "text", id: "contact-linkedin" },
            github: { icon: "fab fa-github", placeholder: "github.com/yourgithub", inputType: "text", id: "contact-github" }
        };

        if (!fields[type]) return;

        const container = document.getElementById("contact-fields");

        if (document.getElementById(`contact-${type}`)) return;

        const wrapper = document.createElement("div");
        wrapper.className = "contact-field";
        wrapper.id = `contact-${type}`;

        wrapper.innerHTML = `
        <i class="${fields[type].icon}"></i>
        <input type="${fields[type].inputType}" placeholder="${fields[type].placeholder}" id="${fields[type].id}"
               oninput="autoGrow('${fields[type].id}')" />
    `;

        container.appendChild(wrapper);
        contactFieldsAdded += 1;
    }

    function finalizeContactFields() {
        const container = document.getElementById("contact-fields");
        const fields = container.querySelectorAll(".contact-field");

        fields.forEach(field => {
            const input = field.querySelector("input");
            const icon = field.querySelector("i");

            if (input && icon) {
                const value = input.value.trim();
                field.innerHTML = '';

                if (value !== '') {
                    const newIcon = document.createElement("i");
                    newIcon.className = icon.className;

                    const span = document.createElement("span");
                    span.textContent = value;
                    span.style.marginLeft = "5px";

                    field.appendChild(newIcon);
                    field.appendChild(span);
                } else {
                    field.remove();
                }
            }
            contactFieldsAdded = 0;
        });

        const options = document.getElementById("contact-options");
        options.style.animation = "fadeOut 0.5s ease";
        setTimeout(() => {
            options.style.display = "none";
        }, 500);
    }

    function removeContactField(type) {
        const field = document.getElementById(`contact-${type}`);
        if (field) field.remove();
    }

    function finalizeContactFields() {
        document.getElementById("contact-options").style.display = "none";
    }

    function addEducation() {
        const div = document.createElement("div");
        div.className = "dynamic-entry";
        div.innerHTML = `
    <div style="display: flex; flex-direction: column; justify-content: flex-start;">
        <div style="display: flex; justify-content: space-between; margin-bottom: 0;">
          <div style="font-size:17px; font-weight:bold; margin-bottom: 0;">
            <textarea style="border:none; width: 100%; height: 17px; font-size:17px; font-weight:bold; margin-bottom: 0;" placeholder="University name"></textarea>
          </div>
          <div style="margin-bottom: 0;">
            <textarea style="border:none; width: 100%; height: 17px; margin-bottom: 0;" placeholder="Years attended"></textarea>
          </div>
        </div>
        <div style="margin:0;">
          <textarea style="border:none; width: 100%; height: 15px; font-size:15px; margin:0;" placeholder="Field of study"></textarea>
        </div>
    </div>
    <ul style="margin:0;">
        <li class="custom-li"><textarea style="border:none; width: 100%; height: 34px; margin:0;" placeholder="Subject, project, or activity"></textarea></li>
    </ul>`;
        document.getElementById("education-list").appendChild(div);
    }

    function addStrength() {
        const container = document.getElementById("strengths");

        const wrapper = document.createElement("div");
        wrapper.style.display = "flex";
        wrapper.style.alignItems = "center";
        wrapper.style.gap = "2px";
        wrapper.style.padding = "6px 6px";
        wrapper.style.border = "1px solid #ccc";
        wrapper.style.borderRadius = "8px";
        wrapper.style.backgroundColor = "#D3D3D3";
        wrapper.style.marginBottom = "10px";
        wrapper.style.width = "fit-content";

        const input = document.createElement("input");
        input.type = "text";
        input.placeholder = "Strength";
        input.style.width = "70px";
        input.style.border = "none";
        input.style.outline = "none";
        input.style.background = "transparent";
        input.style.fontSize = "14px";
        input.style.padding = "0";
        input.style.margin = "0";

        wrapper.appendChild(input);
        container.appendChild(wrapper);
    }
    function addLanguage() {
        const container = document.getElementById("languages");

        const wrapper = document.createElement("div");
        wrapper.style.display = "flex";
        wrapper.style.alignItems = "center";
        wrapper.style.gap = "2px";
        wrapper.style.padding = "6px 6px";
        wrapper.style.border = "1px solid #ccc";
        wrapper.style.borderRadius = "8px";
        wrapper.style.backgroundColor = "#D3D3D3";
        wrapper.style.marginBottom = "10px";
        wrapper.style.width = "fit-content";

        const input = document.createElement("input");
        input.type = "text";
        input.placeholder = "Language";
        input.style.width = "70px";
        input.style.border = "none";
        input.style.outline = "none";
        input.style.background = "transparent";
        input.style.fontSize = "14px";
        input.style.padding = "0";
        input.style.margin = "0";

        const levelWrapper = document.createElement("div");
        levelWrapper.style.display = "flex";
        levelWrapper.style.alignItems = "center";
        levelWrapper.style.gap = "2px";
        levelWrapper.style.marginLeft = "2px";
        levelWrapper.style.background = "transparent";
        levelWrapper.style.border = "none";
        levelWrapper.style.padding = "0";

        let selectedLevel = 0;

        function updateDots(level) {
            if (selectedLevel === level) {
                selectedLevel = 0;
            } else {
                selectedLevel = level;
            }
            Array.from(levelWrapper.children).forEach((dot, index) => {
                dot.textContent = index < selectedLevel ? "●" : "○";
            });
        }

        for (let i = 1; i <= 5; i++) {
            const dot = document.createElement("span");
            dot.textContent = "○";
            dot.style.cursor = "pointer";
            dot.style.fontSize = "16px";
            dot.style.userSelect = "none";
            dot.style.lineHeight = "1";
            dot.style.margin = "0";
            dot.style.padding = "0";
            dot.style.fontFamily = "monospace";
            dot.style.fontWeight = "bold";
            dot.style.color = "#000";
            dot.onclick = () => updateDots(i);
            levelWrapper.appendChild(dot);
        }

        wrapper.appendChild(input);
        wrapper.appendChild(levelWrapper);
        container.appendChild(wrapper);

    }
    function removeLast(listId) {
        const list = document.getElementById(listId);
        if (list.childElementCount > 1) {
            list.removeChild(list.lastElementChild);
        }
    }

    function addRODO() {
        const div = document.createElement("div");
        div.className = "dynamic-entry";
        div.innerHTML = `
        <textarea
            placeholder="Enter here e.g. GDPR clause…"
            style="width: 100%; border: none; background-color: #f9f9f9; padding: 0.5rem; font-family: inherit; font-size: 0.85rem; line-height: 1.4; border-radius: 4px; resize: vertical; min-height: 70px;"></textarea>`;
        document.getElementById("rodo-section").appendChild(div);
    }

    function autoGrow(id) {
        const field = document.getElementById(id);
        if (field) {
            field.style.width = "1px";
            field.style.width = (field.scrollWidth) + "px";
        }
    }

    document.getElementById('toggle-edit').addEventListener('click', function() {
        const addButtonEls = document.querySelectorAll(".add-button");
        const deleteButtonEls = document.querySelectorAll(".delete-button");
        const textAreaEls = document.querySelectorAll("textarea");
        const generatePDFButton = document.getElementById('generate-pdf-btn');

        if (this.innerText === "Finished") {
            addButtonEls.forEach(el => el.style.display = 'none');
            deleteButtonEls.forEach(el => el.style.display = 'none');

            textAreaEls.forEach(el => {
                el.style.border = 'none';
                el.style.resize = 'none';
            });

            generatePDFButton.style.display = 'inline-block';

            this.innerText = "Edit";
        } else {
            addButtonEls.forEach(el => el.style.display = 'inline-block');
            deleteButtonEls.forEach(el => el.style.display = 'inline-block');

            textAreaEls.forEach(el => {
                el.style.border = '1px solid #ccc';
                el.style.resize = 'both';
            });

            generatePDFButton.style.display = 'none';

            this.innerText = "Finished";
        }
    });


    window.onload = () => {
        addExperience();
        addProject();
        addSkill();
        addEducation();
        addStrength();
        addLanguage();
    };

</script>
</body>
</html>
